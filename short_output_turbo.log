Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:00<00:01,  1.62it/s]Loading checkpoint shards:  50%|█████     | 2/4 [00:01<00:01,  1.70it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:01<00:00,  1.66it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:02<00:00,  1.77it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:02<00:00,  1.73it/s]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: BAAI/bge-small-en-v1.5
Load pretrained SentenceTransformer: BAAI/bge-small-en-v1.5
/home/intel/miniforge3/envs/turborag/lib/python3.10/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
INFO:sentence_transformers.SentenceTransformer:2 prompts are loaded, with the keys: ['query', 'text']
2 prompts are loaded, with the keys: ['query', 'text']
INFO:llama_index.core.indices.loading:Loading all indices.
Loading all indices.
The `seen_tokens` attribute is deprecated and will be removed in v4.41. Use the `cache_position` model input instead.
USE_CHUNK_CACHE=reordered_positions
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00, 11.56it/s]
/home/intel/miniforge3/envs/turborag/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:492: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.7` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/intel/miniforge3/envs/turborag/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:497: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.8` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
/home/intel/miniforge3/envs/turborag/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:509: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `20` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
prefix_ids len=88
chunk_token_count_list = [88, 118, 524, 522, 62, 522, 342], chunk sum (except prefix) = 2178
query_ids = 12
chunk_str_ids = 2178
input_ids = 2196
type past_kvcache = <class 'tuple'>
query:How is Shanghai's GDP in 2023?
outputs:I can not answer the question because of the insufficient information in documents. The provided text does not contain any information about Shanghai's GDP in 2023. It only mentions the GDP of Shanghai's neighbor, which is Houston, Texas, with a GDP of 47218.66 billion yuan in 2023. However, it does not provide any data regarding Shanghai's GDP during the same period.
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00, 11.74it/s]
prefix_ids len=88
chunk_token_count_list = [88, 118, 62, 524, 522, 522, 342], chunk sum (except prefix) = 2178
query_ids = 4
chunk_str_ids = 2178
input_ids = 2188
type past_kvcache = <class 'tuple'>
query:How is Shanghai?
outputs:I can not answer the question because of the insufficient information in documents. The provided documents are about musicians, music, and events related to the Houston Symphony and do not contain any information about Shanghai.
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00,  7.91it/s]Batches: 100%|██████████| 1/1 [00:00<00:00,  7.89it/s]
prefix_ids len=88
chunk_token_count_list = [88, 118, 524, 62, 522, 522, 342], chunk sum (except prefix) = 2178
query_ids = 11
chunk_str_ids = 2178
input_ids = 2195
type past_kvcache = <class 'tuple'>
query:Pay attention to Shanghai economy. How is Shanghai GDP?
outputs:I can not answer the question because of the insufficient information in documents. The provided documents do not contain any information about Shanghai's economy or GDP. They are mostly about Paul Wall, a rapper, and some of his musical collaborations and performances.
USE_CHUNK_CACHE=false
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00, 96.39it/s]
prefix_ids len=88
chunk_token_count_list = [88], chunk sum (except prefix) = 88
query_ids = 12
chunk_str_ids = 2178
input_ids = 2196
type past_kvcache = <class 'NoneType'>
query:How is Shanghai's GDP in 2023?
outputs:Shanghai's GDP in 2023 is 47218.66 billion yuan.
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00, 102.67it/s]
prefix_ids len=88
chunk_token_count_list = [88], chunk sum (except prefix) = 88
query_ids = 4
chunk_str_ids = 2178
input_ids = 2188
type past_kvcache = <class 'NoneType'>
query:How is Shanghai?
outputs:Shanghai's economy is robust, with a GDP of 47218.66 billion yuan in 2023, maintaining its leading position among China's economic centers. The city's strategic emerging industries added value of 11692.50 billion yuan, contributing 24.8% to the total GDP. Additionally, the tertiary sector is dominant, accounting for 75.2% of the regional GDP. These figures highlight Shanghai's economic strength
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00, 10.86it/s]
prefix_ids len=88
chunk_token_count_list = [88], chunk sum (except prefix) = 88
query_ids = 11
chunk_str_ids = 2178
input_ids = 2195
type past_kvcache = <class 'NoneType'>
query:Pay attention to Shanghai economy. How is Shanghai GDP?
outputs:According to the document, Shanghai's GDP in 2023 is 47218.66 billion yuan, and it maintains its leading position among China's economic centers.
